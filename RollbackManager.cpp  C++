#include "RollbackManager.h"
#include <iostream>

void RollbackManager::logAllocation(ParkingSlot* slot) {
    history.push(slot); // Stack mein save kar liya
}

void RollbackManager::rollback(int k) {
    std::cout << "Initiating Rollback for last " << k << " operations..." << std::endl;
    for (int i = 0; i < k && !history.empty(); i++) {
        ParkingSlot* lastSlot = history.top();
        
        // Slot availability restore karna
        lastSlot->status = EMPTY; 
        
        std::cout << "Rollback Success: Slot " << lastSlot->slotID << " is now EMPTY." << std::endl;
        history.pop();
    }
}